%#erb
% dir_num = %r{\A/(\d+)(?:\z|/)}.match(req.path)[1].to_i
% dir = @dirs[dir_num]
% stems = @im.image_stem_list(dir)
<html>
  <head>
    <title>BookBox</title>
    <script src="/bookbox.js" type="text/javascript"></script>
    <script>
      var stems = [
        % stems.each {|stem|
          "<%= stem %>",
        % }
      ];
    </script>
  </head>
  <body>
    <table>
      % stems.each_slice(10) {|ss|
      <tr>
        % ss.each {|stem|
        <td>
          % name = "img#{stem[/\d+/]}"
          % color_thumbnail = "/i/#{u(dir_num.to_s)}/#{u("small#{stem}_c.png")}"
          % code = "change_thumbnail('#{stem}')"
          <img name="<%= h(name) %>" src="<%= h(color_thumbnail) %>" onclick="<%= h(code) %>">
        </td>
        % }
      </tr>
      % }
    </table>
    <a href="javascript:thumbnail_all_color(stems, 'c')">all mono</a>
    <a href="javascript:thumbnail_all_color(stems, 'g')">all gray</a>
    <a href="javascript:thumbnail_all_color(stems, 'm')">all mono</a>
  </body>
</html>
